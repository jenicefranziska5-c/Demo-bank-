<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>wisetransfer — Practice Finance App</title>
<style>
  :root{
    --bg:#f7fbff; --card:#ffffff; --accent:#0b74de; --muted:#6b7280;
    --success:#0b8a5f; --danger:#b91c1c;
  }
  *{box-sizing:border-box;font-family:Inter, system-ui, -apple-system, 'Segoe UI', Roboto, Helvetica, Arial;}
  body{margin:0;background:linear-gradient(180deg,#f8fbff 0,#ffffff 100%);color:#0f172a;min-height:100vh}
  .wrap{max-width:1100px;margin:20px auto;padding:18px}
  header{display:flex;justify-content:space-between;align-items:center;margin-bottom:14px}
  .brand{display:flex;gap:12px;align-items:center}
  .logo{width:48px;height:48px;border-radius:10px;background:linear-gradient(135deg,#e9f2ff,#eafcff);display:flex;align-items:center;justify-content:center;font-weight:800;color:var(--accent);font-size:20px}
  .bank-name{font-weight:800;font-size:18px;color:var(--accent)}
  .tiny{font-size:12px;color:var(--muted)}
  .card{background:var(--card);border-radius:12px;padding:16px;box-shadow:0 8px 28px rgba(12,24,48,0.06)}
  .grid{display:grid;grid-template-columns:1fr 360px;gap:16px}
  label{display:block;margin-top:10px;font-size:13px}
  input,select,button{font-family:inherit}
  input,select{width:100%;padding:10px;border-radius:8px;border:1px solid #e6eef8}
  .btn{background:var(--accent);color:#fff;padding:10px 14px;border-radius:10px;border:0;cursor:pointer;font-weight:700}
  .btn-ghost{background:transparent;border:1px solid #e6eef8;color:var(--accent);padding:10px 12px;border-radius:10px;cursor:pointer}
  table{width:100%;border-collapse:collapse;margin-top:10px}
  th,td{padding:10px;border-bottom:1px solid #eef2f7;text-align:left;font-size:13px}
  .balance{font-size:28px;font-weight:800}
  .notice{background:#fffaf0;padding:10px;border-radius:8px;border:1px solid #fde4bf;color:#92400e;margin:12px 0}
  .success{background:#ecffef;padding:12px;border-radius:10px;border:1px solid #c8f7d0;color:var(--success)}
  footer.remark{margin-top:18px;text-align:center;color:var(--muted);font-size:13px}
  .educational{background:#fff2f6;border:1px dashed #f3c6da;color:#9b2c5a;padding:8px;border-radius:8px;text-align:center;margin-bottom:12px;font-weight:700}
  @media (max-width:920px){.grid{grid-template-columns:1fr}.logo{width:40px;height:40px}}
</style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="brand">
        <div class="logo">W</div>
        <div>
          <div class="bank-name">wisetransfer</div>
          <div class="tiny">Smart payments — practice app</div>
        </div>
      </div>
      <div class="tiny" id="headerRight"></div>
    </header>

    <!-- Educational label (cannot be removed for safety) -->
    <div class="educational">PRACTICE / EDUCATIONAL APP — NOT A REAL BANK. For learning and testing only (local browser data).</div>

    <!-- HOME / LOGIN CARD -->
    <div id="homeCard" class="card">
      <div style="display:flex;justify-content:space-between;gap:16px;align-items:center;flex-wrap:wrap">
        <div>
          <h1 style="margin:0;font-size:22px">Welcome to Wisetransfer (Practice)</h1>
          <p class="tiny" style="margin:6px 0 0">Local-only practice app — data saved in your browser.</p>
        </div>
        <div style="min-width:320px" class="card">
          <h3 style="margin:0 0 8px">Sign in</h3>
          <label for="in_user">Username</label>
          <input id="in_user" placeholder="Enter username" />
          <label for="in_pass">Password</label>
          <input id="in_pass" type="password" placeholder="Enter password" />
          <div style="display:flex;gap:8px;margin-top:12px">
            <button id="loginBtn" class="btn">Login</button>
            <button id="quickBtn" class="btn-ghost">Use Demo Account</button>
          </div>
        </div>
      </div>
    </div>

    <!-- DASHBOARD -->
    <div id="dashboard" style="display:none">
      <div class="card" style="display:flex;justify-content:space-between;align-items:center;margin-top:14px">
        <div>
          <div id="greeting" style="font-size:16px;font-weight:700"></div>
          <div class="tiny" id="timeNow"></div>
        </div>
        <div style="text-align:right">
          <div class="tiny">Account balance</div>
          <div id="balance" class="balance">€0.00</div>
          <div class="actions" style="margin-top:10px;display:flex;gap:8px;justify-content:flex-end">
            <button id="openTransfer" class="btn">Transfer</button>
            <button id="openWithdraw" class="btn-ghost">Withdraw</button>
            <button id="logout" class="btn-ghost">Logout</button>
          </div>
        </div>
      </div>

      <div class="grid" style="margin-top:12px">
        <main>
          <div class="card" style="margin-bottom:12px">
            <div style="display:flex;justify-content:space-between;align-items:center">
              <div>
                <h3 style="margin:0">Make a transaction</h3>
                <div class="tiny" style="margin-top:6px">Choose operation, method and pick or enter PayPal / Revolut details.</div>
              </div>
              <div class="tiny">Live rate: <span id="liveRate">—</span></div>
            </div>

            <div class="notice">A charge of <strong>€550</strong> will apply to any transfer or withdrawal.</div>

            <label for="op_mode">Operation</label>
            <select id="op_mode"><option value="transfer">Transfer</option><option value="withdraw">Withdraw</option></select>

            <label for="op_method">Method</label>
            <select id="op_method"><option value="paypal">PayPal</option><option value="revolut">Revolut</option></select>

            <label for="op_bene_select">Or choose beneficiary</label>
            <select id="op_bene_select">
              <option value="">— pick saved beneficiary —</option>
            </select>

            <label for="op_details">PayPal / Revolut details</label>
            <input id="op_details" placeholder="Email for PayPal or phone/IBAN for Revolut" />

            <label for="op_amount">Amount (€)</label>
            <input id="op_amount" type="number" placeholder="0.00" min="1" />

            <div style="margin-top:12px;display:flex;gap:8px">
              <button id="submitTx" class="btn">Submit</button>
              <button id="clearTx" class="btn-ghost">Clear</button>
            </div>
            <div id="txMsg" class="tiny" style="margin-top:8px;color:var(--danger)"></div>
          </div>

          <div class="card">
            <h3 style="margin-top:0">Transaction history</h3>
            <table>
              <thead><tr><th>Date</th><th>Type</th><th>Method</th><th>To</th><th>Amount</th><th>Status</th></tr></thead>
              <tbody id="txHistory"></tbody>
            </table>
            <div id="noHistory" class="tiny" style="margin-top:8px">No transactions yet.</div>
          </div>
        </main>

        <aside class="sidebar">
          <div class="card" style="margin-bottom:12px">
            <h4 style="margin:0 0 8px">Account</h4>
            <p class="tiny">Name: <span id="acctName">Client</span></p>
            <p class="tiny">Account ID: <span id="acctId">WIS-1001</span></p>
            <p class="tiny">Currency: EUR</p>
          </div>

          <div class="card" style="margin-bottom:12px">
            <h4 style="margin:0 0 8px">Beneficiaries</h4>
            <label for="bene_method" class="tiny">Method</label>
            <select id="bene_method"><option value="paypal">PayPal</option><option value="revolut">Revolut</option></select>
            <label for="bene_details" class="tiny">Details</label>
            <input id="bene_details" placeholder="Email for PayPal or phone/IBAN for Revolut" />
            <button id="saveBene" class="btn" style="margin-top:8px;width:100%">Save beneficiary</button>
            <div style="margin-top:12px">
              <h5 style="margin:0 0 6px;font-size:13px">Saved</h5>
              <ul id="beneList" class="tiny" style="padding-left:16px;margin:0"></ul>
            </div>
          </div>

          <div class="card">
            <h4 style="margin:0 0 8px">Quick actions</h4>
            <div style="display:flex;flex-direction:column;gap:8px">
              <button class="btn-ghost nav-btn" id="q5">Send €5</button>
              <button class="btn-ghost nav-btn" id="q100">Send €100</button>
              <button class="btn-ghost nav-btn" id="q1000">Send €1,000</button>
            </div>
          </div>

        </aside>
      </div>

      <footer class="remark card" aria-live="polite">
        Friendly remark: Thank you for using Wisetransfer Practice — keep learning and stay secure! ❤️
      </footer>
    </div>

    <!-- CONFIRM PAGE -->
    <div id="confirmPage" style="display:none;margin-top:18px">
      <div class="card" style="max-width:720px;margin:auto;text-align:center">
        <h2 style="margin-top:0">Confirm transaction</h2>
        <p id="confirmSummary" class="tiny" style="white-space:pre-line"></p>
        <div style="display:flex;gap:10px;justify-content:center;margin-top:12px">
          <button id="confirmBtn" class="btn">Confirm</button>
          <button id="cancelBtn" class="btn-ghost">Cancel</button>
        </div>
      </div>
    </div>

    <!-- SUCCESS PAGE -->
    <div id="successPage" style="display:none;margin-top:18px">
      <div class="card" style="max-width:720px;margin:auto;text-align:center">
        <h2 style="margin-top:0">Transaction processed</h2>
        <div id="successMsg" class="success" style="margin-top:10px"></div>
        <div style="margin-top:12px">
          <button id="backToDash" class="btn">Back to dashboard</button>
        </div>
      </div>
    </div>

  </div>

<script>
/* CONFIG */
const FEE = 550;                // fee in euros
const START_BAL = 19.00;        // starting balance euros
const LS_BAL = 'ws_balance_v1';
const LS_TXS = 'ws_txs_v1';
const LS_USER = 'ws_user_v1';
const LS_BENE = 'ws_bene_v1';

/* BOOTSTRAP STORAGE */
if (!localStorage.getItem(LS_BAL)) localStorage.setItem(LS_BAL, JSON.stringify(START_BAL));
if (!localStorage.getItem(LS_TXS)) {
  // seed history with a previous transfer of €20,000 to Morgan (Revolut)
  const seed = [
    { when: '2025-09-02', type: 'Transfer', method: 'Revolut', to: 'Morgan (Revolut)', amount: 20000, status: 'Completed', display: '-20,000.00' }
  ];
  localStorage.setItem(LS_TXS, JSON.stringify(seed));
}
if (!localStorage.getItem(LS_BENE)) localStorage.setItem(LS_BENE, JSON.stringify([]));

/* DOM */
const homeCard = document.getElementById('homeCard');
const dashboard = document.getElementById('dashboard');
const confirmPage = document.getElementById('confirmPage');
const successPage = document.getElementById('successPage');

const loginBtn = document.getElementById('loginBtn');
const quickBtn = document.getElementById('quickBtn');
const logout = document.getElementById('logout');

const greetingEl = document.getElementById('greeting');
const timeNow = document.getElementById('timeNow');
const balanceEl = document.getElementById('balance');
const liveRateEl = document.getElementById('liveRate');
const headerRight = document.getElementById('headerRight');

const acctName = document.getElementById('acctName');
const acctId = document.getElementById('acctId');

const opMode = document.getElementById('op_mode');
const opMethod = document.getElementById('op_method');
const opBeneSelect = document.getElementById('op_bene_select');
const opDetails = document.getElementById('op_details');
const opAmount = document.getElementById('op_amount');
const submitTx = document.getElementById('submitTx');
const clearTx = document.getElementById('clearTx');
const txMsg = document.getElementById('txMsg');

const txHistory = document.getElementById('txHistory');
const noHistory = document.getElementById('noHistory');

const beneMethod = document.getElementById('bene_method');
const beneDetails = document.getElementById('bene_details');
const saveBene = document.getElementById('saveBene');
const beneList = document.getElementById('beneList');

const confirmSummary = document.getElementById('confirmSummary');
const confirmBtn = document.getElementById('confirmBtn');
const cancelBtn = document.getElementById('cancelBtn');

const successMsg = document.getElementById('successMsg');
const backToDash = document.getElementById('backToDash');

/* HELPERS */
function formatEUR(n){ return '€' + Number(n).toLocaleString(undefined, {minimumFractionDigits:2, maximumFractionDigits:2}); }
function nowStr(){ return new Date().toLocaleString(); }
function greetTime(){ const h=new Date().getHours(); if(h<12) return 'morning'; if(h<18) return 'afternoon'; return 'evening'; }

/* LIVE RATE - small simulated walk */
let baseRate = 1.00;
function updateLiveRate(){
  baseRate += (Math.random()-0.5) * 0.005;
  baseRate = Math.max(0.8, Math.min(1.4, baseRate));
  liveRateEl.textContent = baseRate.toFixed(4);
}
updateLiveRate();
setInterval(updateLiveRate, 2500);

/* CLOCK */
function startClock(){
  timeNow.textContent = nowStr();
  clearInterval(window._wsClock);
  window._wsClock = setInterval(()=> timeNow.textContent = nowStr(), 1000);
}

/* RENDER */
function renderHeader(){
  const bal = Number(JSON.parse(localStorage.getItem(LS_BAL)));
  balanceEl.textContent = formatEUR(bal);
  const user = JSON.parse(localStorage.getItem(LS_USER)) || {name:'Client', id:'WIS-1001'};
  acctName.textContent = user.name; acctId.textContent = user.id;
  greetingEl.textContent = `Good ${greetTime()}, ${user.name}`;
  headerRight.textContent = `${formatEUR(bal)} • ${nowStr().split(',')[0]}`;
}

function renderHistory(){
  const txs = JSON.parse(localStorage.getItem(LS_TXS) || '[]');
  txHistory.innerHTML = '';
  if(!txs || txs.length === 0){ noHistory.style.display = 'block'; return; }
  noHistory.style.display = 'none';
  txs.slice().reverse().forEach(tx => {
    const tr = document.createElement('tr');
    const amtTxt = tx.display ? tx.display : (tx.amount ? (tx.amount > 0 ? `-${Number(tx.amount).toLocaleString(undefined,{minimumFractionDigits:2})}` : Number(tx.amount).toLocaleString(undefined,{minimumFractionDigits:2})) : '-');
    tr.innerHTML = `<td>${tx.when || tx.date || new Date().toLocaleString()}</td>
                    <td>${tx.type}</td>
                    <td>${tx.method}</td>
                    <td class="tiny">${tx.to || tx.details || ''}</td>
                    <td style="font-weight:700">${amtTxt}</td>
                    <td>${tx.status || 'Completed'}</td>`;
    txHistory.appendChild(tr);
  });
}

function renderBeneficiaries(){
  const benes = JSON.parse(localStorage.getItem(LS_BENE) || '[]');
  beneList.innerHTML = '';
  // build select
  opBeneSelect.innerHTML = '<option value="">— pick saved beneficiary —</option>';
  benes.forEach((b, idx) => {
    const li = document.createElement('li');
    li.style.marginBottom = '6px';
    li.innerHTML = `${b.method}: ${b.details} <button data-idx="${idx}" class="tiny use-bene" style="margin-left:8px;border:0;background:none;color:var(--accent);cursor:pointer">Use</button> <button data-idx="${idx}" class="tiny del-bene" style="margin-left:4px;border:0;background:none;color:#b91c1c;cursor:pointer">Delete</button>`;
    beneList.appendChild(li);

    const opt = document.createElement('option');
    opt.value = idx;
    opt.textContent = `${b.method}: ${b.details}`;
    opBeneSelect.appendChild(opt);
  });

  // attach handlers
  document.querySelectorAll('.use-bene').forEach(btn=>{
    btn.onclick = e => {
      const i = e.target.dataset.idx;
      const benes = JSON.parse(localStorage.getItem(LS_BENE) || '[]');
      if(benes[i]){ opMethod.value = benes[i].method; opDetails.value = benes[i].details; window.scrollTo({top:document.body.scrollHeight,behavior:'smooth'}); }
    };
  });
  document.querySelectorAll('.del-bene').forEach(btn=>{
    btn.onclick = e => {
      const i = Number(e.target.dataset.idx);
      const benes = JSON.parse(localStorage.getItem(LS_BENE) || '[]');
      benes.splice(i,1);
      localStorage.setItem(LS_BENE, JSON.stringify(benes));
      renderBeneficiaries();
    };
  });
}

/* PAGE FLOWS */
function showDashboard(){
  homeCard.style.display = 'none';
  dashboard.style.display = 'block';
  confirmPage.style.display = 'none';
  successPage.style.display = 'none';
  startClock();
  renderHeader();
  renderHistory();
  renderBeneficiaries();
}
function showHome(){
  homeCard.style.display = 'block';
  dashboard.style.display = 'none';
  confirmPage.style.display = 'none';
  successPage.style.display = 'none';
  clearInterval(window._wsClock);
}

/* LOGIN */
loginBtn.addEventListener('click', ()=>{
  const u = document.getElementById('in_user').value.trim() || 'Client';
  const user = { name: u, id: 'WIS-' + Math.floor(Math.random()*900000) };
  localStorage.setItem(LS_USER, JSON.stringify(user));
  showDashboard();
});
quickBtn.addEventListener('click', ()=>{
  const user = { name: 'Client', id: 'WIS-1001' };
  localStorage.setItem(LS_USER, JSON.stringify(user));
  showDashboard();
});
logout.addEventListener('click', ()=> {
  localStorage.removeItem(LS_USER);
  showHome();
});

/* QUICK ACTIONS */
document.getElementById('q5').addEventListener('click', ()=> { opAmount.value = 5; opMode.value = 'transfer'; opMethod.value = 'paypal'; });
document.getElementById('q100').addEventListener('click', ()=> { opAmount.value = 100; opMode.value = 'transfer'; opMethod.value = 'revolut'; });
document.getElementById('q1000').addEventListener('click', ()=> { opAmount.value = 1000; opMode.value = 'withdraw'; opMethod.value = 'revolut'; });

/* BENEFICIARY HANDLERS */
saveBene.addEventListener('click', ()=>{
  const method = beneMethod.value;
  const details = beneDetails.value.trim();
  if(!details){ alert('Enter beneficiary details'); return; }
  const benes = JSON.parse(localStorage.getItem(LS_BENE) || '[]');
  benes.push({method,details});
  localStorage.setItem(LS_BENE, JSON.stringify(benes));
  beneDetails.value = '';
  renderBeneficiaries();
});
opBeneSelect.addEventListener('change', ()=>{
  const idx = opBeneSelect.value;
  if(idx === '') return;
  const benes = JSON.parse(localStorage.getItem(LS_BENE) || '[]');
  if(benes[idx]){ opMethod.value = benes[idx].method; opDetails.value = benes[idx
